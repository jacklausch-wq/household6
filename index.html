<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://www.gstatic.com https://cdnjs.cloudflare.com https://*.firebaseapp.com https://*.googleapis.com 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self' https://*.firebaseio.com https://*.googleapis.com https://*.cloudfunctions.net https://*.workers.dev wss://*.firebaseio.com; img-src 'self' data: https:; font-src 'self' https://fonts.gstatic.com; frame-src https://*.firebaseapp.com https://accounts.google.com;">
    <meta name="theme-color" content="#7D9B8C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Household6">
    <title>Household6</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="app">
        <!-- Auth Screen -->
        <div id="auth-screen" class="screen">
            <div class="auth-container">
                <div class="logo">
                    <div class="logo-icon">6</div>
                    <h1>Household6</h1>
                    <p class="tagline">Your household command center</p>
                </div>
                <button id="google-signin-btn" class="btn btn-google">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Sign in with Google
                </button>
                <p class="auth-legal">By signing in, you agree to our <a href="terms.html">Terms of Service</a> and <a href="privacy.html">Privacy Policy</a></p>
            </div>
        </div>

        <!-- Household Setup Screen -->
        <div id="household-screen" class="screen hidden">
            <div class="household-container">
                <h2>Welcome to Household6</h2>
                <p>Create a new household or join an existing one</p>

                <div class="household-options">
                    <button id="create-household-btn" class="btn btn-primary">
                        Create New Household
                    </button>

                    <div class="divider"><span>or</span></div>

                    <div class="join-section">
                        <input type="text" id="invite-code-input" placeholder="Enter invite code" maxlength="6">
                        <button id="join-household-btn" class="btn btn-secondary">Join</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main App Screen -->
        <div id="main-screen" class="screen hidden">
            <!-- Header -->
            <header class="app-header">
                <h1 id="household-name">My Household</h1>
                <button id="settings-btn" class="icon-btn" aria-label="Settings">
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                    </svg>
                </button>
            </header>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button id="voice-btn" class="action-btn voice-btn" aria-label="Voice input">
                    <svg viewBox="0 0 24 24" width="32" height="32" fill="currentColor">
                        <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
                    </svg>
                </button>
            </div>

            <!-- Text Input Bar -->
            <div class="input-bar">
                <input type="text" id="text-input" placeholder="Type or paste text here..." autocomplete="off">
                <label id="upload-btn" class="upload-btn" aria-label="Upload document">
                    <input type="file" id="file-input" accept=".pdf,.txt,.doc,.docx,image/*" hidden>
                    <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                        <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm4 18H6V4h7v5h5v11zm-3-7v4h-2v-4H9l4-4 4 4h-4z"/>
                    </svg>
                </label>
            </div>

            <!-- Tab Navigation -->
            <nav class="tab-nav tab-nav-scrollable">
                <button class="tab-btn active" data-tab="today">Today</button>
                <button class="tab-btn" data-tab="tasks">Tasks</button>
                <button class="tab-btn" data-tab="shopping">Shopping</button>
                <button class="tab-btn" data-tab="agenda">Agenda</button>
                <button class="tab-btn" data-tab="recipes">Recipes</button>
                <button class="tab-btn" data-tab="inventory">Inventory</button>
                <button class="tab-btn" data-tab="planner">Planner</button>
                <button class="tab-btn" data-tab="calendar">Calendar</button>
            </nav>

            <!-- Tab Content -->
            <main class="tab-content">
                <!-- Today Tab -->
                <div id="today-tab" class="tab-panel active">
                    <section class="today-section">
                        <h3>Today's Schedule</h3>
                        <div id="today-events" class="event-list">
                            <p class="empty-state">No events today</p>
                        </div>
                    </section>
                    <section class="today-section">
                        <h3>Pending Tasks</h3>
                        <div id="today-tasks" class="task-list">
                            <p class="empty-state">No pending tasks</p>
                        </div>
                    </section>
                </div>

                <!-- Tasks Tab -->
                <div id="tasks-tab" class="tab-panel hidden">
                    <div class="tasks-header">
                        <h3>All Tasks</h3>
                        <button id="add-task-btn" class="btn btn-small">+ Add Task</button>
                    </div>
                    <div id="all-tasks" class="task-list">
                        <p class="empty-state">No tasks yet</p>
                    </div>
                </div>

                <!-- Shopping Tab -->
                <div id="shopping-tab" class="tab-panel hidden">
                    <div class="shopping-header">
                        <h3>Shopping List</h3>
                        <button id="clear-checked-btn" class="btn btn-small btn-secondary">Clear Checked</button>
                    </div>
                    <div id="shopping-list" class="shopping-list">
                        <p class="empty-state">No items on your list</p>
                    </div>
                    <div id="checked-items" class="checked-items hidden">
                        <h4 class="section-label checked-label">Checked Off</h4>
                        <div id="checked-items-list"></div>
                    </div>
                </div>

                <!-- Agenda Tab -->
                <div id="agenda-tab" class="tab-panel hidden">
                    <div class="agenda-header">
                        <h3>Household Meeting Agenda</h3>
                        <button id="add-agenda-btn" class="btn btn-small">+ Add Item</button>
                    </div>
                    <p class="agenda-description">Items to discuss at your next family meeting</p>
                    <div id="agenda-sections">
                        <div class="agenda-section">
                            <h4 class="section-label">To Discuss</h4>
                            <div id="agenda-pending" class="agenda-list">
                                <p class="empty-state">No agenda items. Add topics for your next meeting!</p>
                            </div>
                        </div>
                        <div class="agenda-section resolved-section hidden" id="resolved-section">
                            <h4 class="section-label resolved-label">Resolved</h4>
                            <div id="agenda-resolved" class="agenda-list resolved-list"></div>
                            <button id="clear-resolved-btn" class="btn btn-small btn-secondary">Clear Resolved</button>
                        </div>
                    </div>
                </div>

                <!-- Recipes Tab -->
                <div id="recipes-tab" class="tab-panel hidden">
                    <div class="recipes-header">
                        <h3>Recipes</h3>
                        <div class="header-actions">
                            <button id="import-recipe-btn" class="btn btn-small btn-secondary">Import</button>
                            <button id="add-recipe-btn" class="btn btn-small">+ Add</button>
                        </div>
                    </div>
                    <div class="search-bar">
                        <input type="text" id="recipe-search" placeholder="Search recipes..." autocomplete="off">
                    </div>
                    <div id="recipes-list" class="recipes-list">
                        <p class="empty-state">No recipes yet. Add your first recipe!</p>
                    </div>
                </div>

                <!-- Inventory Tab -->
                <div id="inventory-tab" class="tab-panel hidden">
                    <div class="inventory-header">
                        <h3>Inventory</h3>
                        <button id="add-inventory-btn" class="btn btn-small">+ Add</button>
                    </div>
                    <div class="inventory-location-tabs">
                        <button class="location-tab active" data-location="Refrigerator">Fridge</button>
                        <button class="location-tab" data-location="Freezer">Freezer</button>
                        <button class="location-tab" data-location="Pantry">Pantry</button>
                    </div>
                    <div id="expiring-section" class="expiring-section hidden">
                        <h4 class="section-label expiring-label">Expiring Soon</h4>
                        <div id="expiring-items" class="inventory-list"></div>
                    </div>
                    <div id="inventory-list" class="inventory-list">
                        <p class="empty-state">No items in inventory</p>
                    </div>
                </div>

                <!-- Meal Planner Tab -->
                <div id="planner-tab" class="tab-panel hidden">
                    <div class="planner-header">
                        <h3>Meal Planner</h3>
                        <button id="plan-week-btn" class="btn btn-small btn-primary">Plan Week</button>
                    </div>
                    <div class="week-navigation">
                        <button id="prev-week" class="icon-btn">&lt;</button>
                        <span id="week-range">This Week</span>
                        <button id="next-week" class="icon-btn">&gt;</button>
                    </div>
                    <div id="meal-plan-view" class="meal-plan-view">
                        <p class="empty-state">No meals planned. Tap "Plan Week" to get started!</p>
                    </div>
                    <div id="grocery-preview" class="grocery-preview hidden">
                        <h4 class="section-label">Grocery List Preview</h4>
                        <div id="grocery-preview-list"></div>
                        <button id="add-to-shopping-btn" class="btn btn-primary btn-full">Add Missing Items to Shopping</button>
                    </div>
                </div>

                <!-- Calendar Tab -->
                <div id="calendar-tab" class="tab-panel hidden">
                    <div class="calendar-header">
                        <button id="prev-month" class="icon-btn">&lt;</button>
                        <h3 id="calendar-month">January 2026</h3>
                        <button id="next-month" class="icon-btn">&gt;</button>
                    </div>
                    <div id="calendar-grid" class="calendar-grid">
                        <!-- Calendar will be rendered here -->
                    </div>
                    <div id="selected-day-section" class="selected-day-section hidden">
                        <div class="selected-day-header">
                            <h4 id="selected-day-title">Events</h4>
                            <span id="selected-day-date"></span>
                        </div>
                        <div id="selected-day-events" class="day-events-list"></div>
                    </div>
                    <div class="upcoming-events-section">
                        <h4 class="section-label">Upcoming Events</h4>
                        <div id="upcoming-events" class="upcoming-events-list">
                            <p class="empty-state">No upcoming events</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Voice Input Modal -->
        <div id="voice-modal" class="modal hidden">
            <div class="modal-content voice-modal-content">
                <button id="voice-close-btn" class="close-btn">&times;</button>
                <div class="voice-status">
                    <div id="voice-indicator" class="voice-indicator">
                        <div class="pulse-ring"></div>
                        <svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor">
                            <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
                        </svg>
                    </div>
                    <p id="voice-status-text">Listening...</p>
                </div>
                <div id="voice-transcript" class="voice-transcript"></div>
                <div id="voice-result" class="voice-result hidden">
                    <div id="parsed-result"></div>
                    <div class="voice-actions">
                        <button id="voice-confirm-btn" class="btn btn-primary">Confirm</button>
                        <button id="voice-retry-btn" class="btn btn-secondary">Try Again</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task Modal -->
        <div id="task-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="task-modal">&times;</button>
                <h2 id="task-modal-title">Add Task</h2>
                <form id="task-form">
                    <div class="form-group">
                        <label for="task-title">Task</label>
                        <input type="text" id="task-title" required placeholder="What needs to be done?">
                    </div>
                    <div class="form-group">
                        <label for="task-assignee">Assign to</label>
                        <select id="task-assignee">
                            <option value="">Anyone</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="task-recurring">
                            Recurring task
                        </label>
                    </div>
                    <div id="recurring-options" class="form-group hidden">
                        <label for="task-frequency">Repeat</label>
                        <select id="task-frequency">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Save Task</button>
                </form>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="settings-modal">&times;</button>
                <h2>Settings</h2>

                <div class="settings-section">
                    <h3>Household</h3>
                    <div class="setting-item">
                        <span>Invite Code</span>
                        <div class="invite-code-display">
                            <code id="current-invite-code">------</code>
                            <button id="copy-invite-code" class="btn btn-small">Copy</button>
                        </div>
                    </div>
                    <div class="setting-item">
                        <span>Members</span>
                        <div id="household-members" class="members-list"></div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Calendar</h3>
                    <div id="calendar-not-connected" class="setting-item">
                        <p style="margin-bottom: 12px; color: var(--text-light);">Connect your Google Calendar to sync events</p>
                        <button id="connect-calendar-btn" class="btn btn-primary btn-full">Connect Google Calendar</button>
                    </div>
                    <div id="calendar-connected" class="setting-item hidden">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                            <span style="color: var(--success);">&#10003;</span>
                            <span>Calendar connected</span>
                        </div>
                        <label for="calendar-select">Sync with calendar</label>
                        <select id="calendar-select">
                            <option value="">Select a calendar...</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    <div class="setting-item">
                        <label for="theme-select">Theme</label>
                        <select id="theme-select">
                            <option value="system">System</option>
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                        </select>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Notifications</h3>
                    <div class="setting-item">
                        <label for="morning-report-time">Morning report time</label>
                        <input type="time" id="morning-report-time" value="07:00">
                    </div>
                    <div class="setting-item">
                        <label for="buffer-time">Reminder buffer (minutes before leaving)</label>
                        <input type="number" id="buffer-time" value="20" min="0" max="120">
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Locations</h3>
                    <div class="setting-item">
                        <label for="home-address">Home address</label>
                        <input type="text" id="home-address" placeholder="Enter your home address">
                    </div>
                    <div class="setting-item">
                        <span>Saved Locations</span>
                        <button id="add-location-btn" class="btn btn-small">+ Add</button>
                    </div>
                    <div id="saved-locations" class="locations-list"></div>
                </div>

                <div class="settings-section">
                    <button id="sign-out-btn" class="btn btn-danger btn-full">Sign Out</button>
                </div>

                <div class="settings-section settings-legal">
                    <a href="terms.html">Terms of Service</a>
                    <span class="legal-divider">|</span>
                    <a href="privacy.html">Privacy Policy</a>
                </div>
            </div>
        </div>

        <!-- Location Modal -->
        <div id="location-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="location-modal">&times;</button>
                <h2>Add Saved Location</h2>
                <form id="location-form">
                    <div class="form-group">
                        <label for="location-name">Name (e.g., "Kids doctor")</label>
                        <input type="text" id="location-name" required placeholder="Location nickname">
                    </div>
                    <div class="form-group">
                        <label for="location-address">Address</label>
                        <input type="text" id="location-address" required placeholder="Full address">
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Save Location</button>
                </form>
            </div>
        </div>

        <!-- Document Preview Modal -->
        <div id="document-modal" class="modal hidden">
            <div class="modal-content document-modal-content">
                <button class="close-btn" data-close="document-modal">&times;</button>
                <h2 id="document-modal-title">Processing Document...</h2>
                <div id="document-loading" class="document-loading">
                    <div class="spinner"></div>
                    <p>Extracting events and tasks...</p>
                </div>
                <div id="document-preview" class="document-preview hidden">
                    <p class="preview-summary" id="preview-summary"></p>
                    <div id="preview-items" class="preview-items"></div>
                    <div class="document-actions">
                        <button id="document-confirm-btn" class="btn btn-primary">Create All</button>
                        <button id="document-cancel-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
                <div id="document-error" class="document-error hidden">
                    <p id="document-error-msg"></p>
                    <button id="document-retry-btn" class="btn btn-secondary">Try Again</button>
                </div>
            </div>
        </div>

        <!-- Recipe Modal -->
        <div id="recipe-modal" class="modal hidden">
            <div class="modal-content recipe-modal-content">
                <button class="close-btn" data-close="recipe-modal">&times;</button>
                <h2 id="recipe-modal-title">Add Recipe</h2>
                <form id="recipe-form">
                    <div class="form-group">
                        <label for="recipe-name">Recipe Name</label>
                        <input type="text" id="recipe-name" required placeholder="e.g., Chicken Alfredo">
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-half">
                            <label for="recipe-category">Category</label>
                            <select id="recipe-category">
                                <option value="Uncategorized">Select category...</option>
                            </select>
                        </div>
                        <div class="form-group form-group-half">
                            <label for="recipe-servings">Servings</label>
                            <input type="number" id="recipe-servings" value="4" min="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-half">
                            <label for="recipe-prep-time">Prep Time (min)</label>
                            <input type="number" id="recipe-prep-time" placeholder="15" min="0">
                        </div>
                        <div class="form-group form-group-half">
                            <label for="recipe-cook-time">Cook Time (min)</label>
                            <input type="number" id="recipe-cook-time" placeholder="30" min="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ingredients</label>
                        <div id="ingredients-list" class="ingredients-list">
                            <!-- Ingredients added dynamically -->
                        </div>
                        <div class="add-ingredient-row">
                            <input type="text" id="new-ingredient" placeholder="e.g., 2 cups flour">
                            <button type="button" id="add-ingredient-btn" class="btn btn-small">Add</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="recipe-instructions">Instructions</label>
                        <textarea id="recipe-instructions" rows="4" placeholder="Step by step instructions..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="recipe-source">Source URL (optional)</label>
                        <input type="url" id="recipe-source" placeholder="https://...">
                    </div>
                    <input type="hidden" id="recipe-edit-id">
                    <button type="submit" class="btn btn-primary btn-full">Save Recipe</button>
                </form>
            </div>
        </div>

        <!-- Recipe Import Modal -->
        <div id="recipe-import-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="recipe-import-modal">&times;</button>
                <h2>Import Recipe</h2>
                <div class="import-options">
                    <div class="import-option">
                        <label class="import-upload-area" id="recipe-upload-area">
                            <input type="file" id="recipe-file-input" accept="image/*,.pdf,.txt" hidden>
                            <svg viewBox="0 0 24 24" width="48" height="48" fill="currentColor">
                                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                            </svg>
                            <span>Upload screenshot or photo</span>
                            <span class="import-hint">Supports images and PDFs</span>
                        </label>
                    </div>
                    <div class="divider"><span>or</span></div>
                    <div class="import-option">
                        <label for="recipe-paste-text">Paste recipe text</label>
                        <textarea id="recipe-paste-text" rows="6" placeholder="Paste your recipe here..."></textarea>
                        <button type="button" id="parse-recipe-text-btn" class="btn btn-secondary btn-full">Parse Recipe</button>
                    </div>
                </div>
                <div id="recipe-import-loading" class="document-loading hidden">
                    <div class="spinner"></div>
                    <p>Parsing recipe with AI...</p>
                </div>
                <div id="recipe-import-preview" class="hidden">
                    <h3>Parsed Recipe Preview</h3>
                    <div id="parsed-recipe-preview"></div>
                    <div class="document-actions">
                        <button id="recipe-import-confirm-btn" class="btn btn-primary">Save Recipe</button>
                        <button id="recipe-import-edit-btn" class="btn btn-secondary">Edit First</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recipe View Modal -->
        <div id="recipe-view-modal" class="modal hidden">
            <div class="modal-content recipe-view-content">
                <button class="close-btn" data-close="recipe-view-modal">&times;</button>
                <div id="recipe-view-header" class="recipe-view-header">
                    <h2 id="recipe-view-name">Recipe Name</h2>
                    <div class="recipe-view-meta">
                        <span id="recipe-view-category" class="category-badge">Category</span>
                        <span id="recipe-view-time" class="recipe-time"></span>
                    </div>
                </div>
                <div class="recipe-view-actions">
                    <button id="recipe-favorite-btn" class="icon-btn" title="Favorite">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                    </button>
                    <button id="recipe-edit-btn" class="icon-btn" title="Edit">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                        </svg>
                    </button>
                    <button id="recipe-delete-btn" class="icon-btn" title="Delete">
                        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                    </button>
                </div>
                <div class="recipe-view-section">
                    <h4>Ingredients <span id="recipe-view-servings">(4 servings)</span></h4>
                    <ul id="recipe-view-ingredients" class="recipe-ingredients-list"></ul>
                </div>
                <div class="recipe-view-section">
                    <h4>Instructions</h4>
                    <div id="recipe-view-instructions" class="recipe-instructions"></div>
                </div>
                <div class="recipe-view-footer">
                    <button id="add-recipe-to-plan-btn" class="btn btn-secondary">Add to Meal Plan</button>
                    <button id="add-ingredients-to-shopping-btn" class="btn btn-primary">Add to Shopping List</button>
                </div>
            </div>
        </div>

        <!-- Inventory Modal -->
        <div id="inventory-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="inventory-modal">&times;</button>
                <h2 id="inventory-modal-title">Add to Inventory</h2>
                <form id="inventory-form">
                    <div class="form-group">
                        <label for="inventory-name">Item Name</label>
                        <input type="text" id="inventory-name" required placeholder="e.g., Chicken breast">
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-half">
                            <label for="inventory-quantity">Quantity</label>
                            <input type="number" id="inventory-quantity" value="1" min="0" step="0.5">
                        </div>
                        <div class="form-group form-group-half">
                            <label for="inventory-unit">Unit</label>
                            <select id="inventory-unit">
                                <option value="">-</option>
                                <option value="lbs">lbs</option>
                                <option value="oz">oz</option>
                                <option value="cups">cups</option>
                                <option value="pieces">pieces</option>
                                <option value="packages">packages</option>
                                <option value="bottles">bottles</option>
                                <option value="cans">cans</option>
                                <option value="bags">bags</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inventory-location">Storage Location</label>
                        <select id="inventory-location" required>
                            <option value="Refrigerator">Refrigerator</option>
                            <option value="Freezer">Freezer</option>
                            <option value="Pantry">Pantry</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="inventory-expiration">Expiration Date</label>
                        <input type="date" id="inventory-expiration">
                    </div>
                    <div class="form-group">
                        <label for="inventory-notes">Notes (optional)</label>
                        <input type="text" id="inventory-notes" placeholder="e.g., Opened on Monday">
                    </div>
                    <input type="hidden" id="inventory-edit-id">
                    <button type="submit" class="btn btn-primary btn-full">Save Item</button>
                </form>
            </div>
        </div>

        <!-- Meal Planner Wizard Modal -->
        <div id="planner-wizard-modal" class="modal hidden">
            <div class="modal-content planner-wizard-content">
                <button class="close-btn" data-close="planner-wizard-modal">&times;</button>
                <div class="wizard-progress">
                    <div class="wizard-step active" data-step="1">1</div>
                    <div class="wizard-step" data-step="2">2</div>
                    <div class="wizard-step" data-step="3">3</div>
                    <div class="wizard-step" data-step="4">4</div>
                    <div class="wizard-step" data-step="5">5</div>
                </div>

                <!-- Step 1: Days needed -->
                <div id="wizard-step-1" class="wizard-panel active">
                    <h2>How many meals this week?</h2>
                    <p class="wizard-description">Select which days you need to cook dinner</p>
                    <div class="day-selector">
                        <label class="day-checkbox"><input type="checkbox" value="Sun" checked><span>Sun</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Mon" checked><span>Mon</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Tue" checked><span>Tue</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Wed" checked><span>Wed</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Thu" checked><span>Thu</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Fri" checked><span>Fri</span></label>
                        <label class="day-checkbox"><input type="checkbox" value="Sat" checked><span>Sat</span></label>
                    </div>
                    <div class="wizard-nav">
                        <button type="button" class="btn btn-primary wizard-next">Next</button>
                    </div>
                </div>

                <!-- Step 2: Items to use up -->
                <div id="wizard-step-2" class="wizard-panel hidden">
                    <h2>Items to use up</h2>
                    <p class="wizard-description">Select items expiring soon that you want to prioritize</p>
                    <div id="use-up-items" class="checklist">
                        <p class="empty-state">No items expiring soon</p>
                    </div>
                    <div class="wizard-nav">
                        <button type="button" class="btn btn-secondary wizard-back">Back</button>
                        <button type="button" class="btn btn-primary wizard-next">Next</button>
                    </div>
                </div>

                <!-- Step 3: Category requirements -->
                <div id="wizard-step-3" class="wizard-panel hidden">
                    <h2>Meal variety</h2>
                    <p class="wizard-description">How many of each type of meal do you want?</p>
                    <div id="category-requirements" class="category-requirements">
                        <!-- Categories added dynamically -->
                    </div>
                    <div class="wizard-nav">
                        <button type="button" class="btn btn-secondary wizard-back">Back</button>
                        <button type="button" class="btn btn-primary wizard-next">Next</button>
                    </div>
                </div>

                <!-- Step 4: Must-include recipes -->
                <div id="wizard-step-4" class="wizard-panel hidden">
                    <h2>Must-include recipes</h2>
                    <p class="wizard-description">Any recipes you definitely want to make this week?</p>
                    <div class="search-bar">
                        <input type="text" id="must-include-search" placeholder="Search your recipes...">
                    </div>
                    <div id="must-include-list" class="recipe-select-list">
                        <!-- Recipes shown here -->
                    </div>
                    <div id="selected-must-include" class="selected-recipes">
                        <h4>Selected recipes:</h4>
                        <div id="must-include-selected-list"></div>
                    </div>
                    <div class="wizard-nav">
                        <button type="button" class="btn btn-secondary wizard-back">Back</button>
                        <button type="button" class="btn btn-primary wizard-next">Generate Suggestions</button>
                    </div>
                </div>

                <!-- Step 5: Review suggestions -->
                <div id="wizard-step-5" class="wizard-panel hidden">
                    <h2>Your meal plan</h2>
                    <p class="wizard-description">Review and adjust your suggested meals</p>
                    <div id="meal-suggestions" class="meal-suggestions">
                        <!-- Suggestions rendered here -->
                    </div>
                    <div id="suggestion-stats" class="suggestion-stats"></div>
                    <div class="wizard-nav">
                        <button type="button" class="btn btn-secondary wizard-back">Back</button>
                        <button type="button" id="regenerate-btn" class="btn btn-secondary">Regenerate</button>
                        <button type="button" id="accept-plan-btn" class="btn btn-primary">Accept Plan</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ingredient Check Modal -->
        <div id="ingredient-check-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="ingredient-check-modal">&times;</button>
                <h2>What do you have?</h2>
                <p class="wizard-description">Check off ingredients you already have at home</p>
                <div id="ingredient-checklist" class="ingredient-checklist">
                    <!-- Ingredients listed here -->
                </div>
                <div class="ingredient-check-summary">
                    <span id="have-count">0</span> items you have | <span id="need-count">0</span> items to buy
                </div>
                <div class="document-actions">
                    <button id="ingredient-check-done-btn" class="btn btn-primary">Add Missing to Shopping List</button>
                </div>
            </div>
        </div>

        <!-- Recipe Select Modal (for meal planner) -->
        <div id="recipe-select-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="recipe-select-modal">&times;</button>
                <h2>Select a Recipe</h2>
                <div class="search-bar">
                    <input type="text" id="recipe-select-search" placeholder="Search recipes...">
                </div>
                <div id="recipe-select-list" class="recipe-select-list">
                    <!-- Recipes listed here -->
                </div>
            </div>
        </div>

        <!-- Agenda Item Modal -->
        <div id="agenda-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="agenda-modal">&times;</button>
                <h2 id="agenda-modal-title">Add Agenda Item</h2>
                <form id="agenda-form">
                    <div class="form-group">
                        <label for="agenda-topic">Topic</label>
                        <input type="text" id="agenda-topic" required placeholder="e.g., Vacation planning">
                    </div>
                    <div class="form-group">
                        <label for="agenda-description">Details (optional)</label>
                        <textarea id="agenda-description" rows="3" placeholder="Additional context or notes..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="agenda-priority">Priority</label>
                        <select id="agenda-priority">
                            <option value="normal">Normal</option>
                            <option value="high">High - Discuss First</option>
                            <option value="low">Low - If Time Permits</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="agenda-added-by">Added by</label>
                        <input type="text" id="agenda-added-by" readonly>
                    </div>
                    <input type="hidden" id="agenda-edit-id">
                    <button type="submit" class="btn btn-primary btn-full">Save Item</button>
                </form>
            </div>
        </div>

        <!-- Category Manager Modal -->
        <div id="category-modal" class="modal hidden">
            <div class="modal-content">
                <button class="close-btn" data-close="category-modal">&times;</button>
                <h2>Manage Categories</h2>
                <div id="category-list" class="category-manager-list">
                    <!-- Categories listed here -->
                </div>
                <div class="add-category-row">
                    <input type="text" id="new-category-name" placeholder="New category name">
                    <button type="button" id="add-category-btn" class="btn btn-small">Add</button>
                </div>
            </div>
        </div>

        <!-- Household Created Modal -->
        <div id="household-created-modal" class="modal hidden">
            <div class="modal-content household-created-content">
                <div class="success-icon">
                    <svg viewBox="0 0 24 24" width="64" height="64" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                    </svg>
                </div>
                <h2>Household Created!</h2>
                <p class="modal-description">Share this invite code with family members to let them join your household:</p>
                <div class="invite-code-large">
                    <code id="new-household-invite-code">------</code>
                </div>
                <div class="invite-code-actions">
                    <button id="copy-new-invite-code" class="btn btn-secondary">Copy Code</button>
                    <button id="share-invite-code" class="btn btn-secondary">Share</button>
                </div>
                <p class="invite-code-note">This code expires in 7 days. You can generate a new one anytime in Settings.</p>
                <button id="household-created-continue" class="btn btn-primary btn-full">Continue to App</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <!-- PDF.js for document extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <!-- App Scripts -->
    <script src="js/security.js"></script>
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/household.js"></script>
    <script src="js/tasks.js"></script>
    <script src="js/shopping.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/gemini.js"></script>
    <script src="js/voice.js"></script>
    <script src="js/locations.js"></script>
    <script src="js/reminders.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/recipes.js"></script>
    <script src="js/inventory.js"></script>
    <script src="js/meal-categories.js"></script>
    <script src="js/meal-planner.js"></script>
    <script src="js/agenda.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
